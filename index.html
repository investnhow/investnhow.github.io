<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>InvestNow - Secure Investment Platform</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<style>
  body { background: #f4f7fa; }
  .dashboard-card { background: #fff; border-radius: 14px; padding: 2rem; box-shadow: 0 2px 16px rgba(0,0,0,0.07);}
  .nav-link.active { font-weight: bold; color: #198754 !important; }
  .plan-card { border-radius: 12px; border: 1px solid #ddd; transition: box-shadow 0.3s ease; }
  .plan-card:hover { box-shadow: 0 8px 20px rgba(25, 135, 84, 0.3); }
  .investment-table th, .investment-table td { vertical-align: middle; }
  @media (max-width: 767px) {
    .dashboard-card, .landing-hero { padding: 1rem; }
    h2 { font-size: 1.5rem; }
  }
</style>
</head>
<body>
<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
  <div class="container">
    <a class="navbar-brand fw-bold text-success" href="#home" id="nav-home"><i class="fas fa-chart-line"></i> InvestNow</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ul class="navbar-nav" id="nav-links"></ul>
    </div>
  </div>
</nav>

<!-- Landing Section -->
<div class="container my-5" id="landing-section">
  <div class="landing-hero text-center mb-4">
    <h1 class="display-5 fw-bold mb-3">Grow Your Wealth with InvestNow</h1>
    <p class="lead mb-4">Simple, secure, and transparent investment opportunities. Track your returns and manage your portfolio in real time.</p>
    <button class="btn btn-success btn-lg px-5" id="get-started-btn"><i class="fas fa-play-circle"></i> Get Started</button>
  </div>
</div>

<!-- Login Section -->
<div class="container my-5" id="login-section" style="max-width: 400px; display:none;">
  <div class="card p-4 shadow-sm">
    <h3 class="mb-3">Login</h3>
    <form id="loginForm">
      <div class="mb-3">
        <label for="login-email" class="form-label">Email</label>
        <input type="email" class="form-control" id="login-email" required />
      </div>
      <button type="submit" class="btn btn-success w-100">Login</button>
    </form>
    <div class="mt-3 text-center">
      <a href="#signup" id="show-signup">Don't have an account? Sign up</a>
    </div>
    <div id="login-alert" class="alert alert-danger mt-3 d-none"></div>
  </div>
</div>

<!-- Signup Section -->
<div class="container my-5" id="signup-section" style="max-width: 400px; display:none;">
  <div class="card p-4 shadow-sm">
    <h3 class="mb-3">Sign Up</h3>
    <form id="signupForm" action="https://formspree.io/f/xzzgqebn" method="POST" data-formspree>
      <div id="signup-fields">
        <div class="mb-3">
          <label for="signup-fullname" class="form-label">Full Name</label>
          <input type="text" class="form-control" id="signup-fullname" name="fullName" required />
        </div>
        <div class="mb-3">
          <label for="signup-email" class="form-label">Email</label>
          <input type="email" class="form-control" id="signup-email" name="email" required />
        </div>
        <button type="submit" class="btn btn-success w-100">Sign Up</button>
      </div>

      <div id="verification-section" class="d-none mt-3">
        <p>A verification code has been generated.</p>
        <p><strong id="displayVerificationCode" style="font-size:1.5rem; letter-spacing: 0.2em; user-select: all; cursor: pointer;"></strong></p>
        <button type="button" id="copyCodeBtn" class="btn btn-outline-primary mb-3 w-100">Copy & Paste Code</button>
        <div class="mb-3">
          <label for="verification-code" class="form-label">Enter Verification Code</label>
          <input type="text" id="verification-code" class="form-control" placeholder="Enter code here" />
          <div id="verification-error" class="text-danger mt-2 d-none">Incorrect code. Please try again.</div>
        </div>
        <button type="button" id="verify-btn" class="btn btn-primary w-100">Verify</button>
      </div>
    </form>
    <div class="mt-3 text-center">
      <a href="#login" id="show-login">Already have an account? Log in</a>
    </div>
    <div id="signup-alert" class="alert alert-danger mt-3 d-none"></div>
  </div>
</div>

<!-- Dashboard Section -->
<div class="dashboard-card mx-auto" id="dashboard-section" style="max-width: 950px; display:none;">
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mb-4 gap-3">
    <div>
      <h2 class="mb-1">Welcome, <span id="userName"></span></h2>
      <p class="mb-0 text-muted">Track your investments and returns in real time.</p>
    </div>
    <button class="btn btn-outline-danger" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
  </div>

  <!-- Summary Cards -->
  <div class="row mb-4" id="summary-cards">
    <div class="col-md-4 mb-3">
      <div class="p-4 bg-success text-white rounded-4 shadow-sm text-center">
        <h5>Total Invested</h5>
        <h3 id="total-invested">$0.00</h3>
      </div>
    </div>
    <div class="col-md-4 mb-3">
      <div class="p-4 bg-primary text-white rounded-4 shadow-sm text-center">
        <h5>Current Value</h5>
        <h3 id="current-value">$0.00</h3>
      </div>
    </div>
    <div class="col-md-4 mb-3">
      <div class="p-4 bg-warning text-white rounded-4 shadow-sm text-center">
        <h5>Total Returns</h5>
        <h3 id="total-returns">$0.00</h3>
      </div>
    </div>
  </div>

  <!-- Investment Plans -->
  <h3 class="mb-3">Available Investment Plans</h3>
  <div class="row" id="investment-plans"></div>

  <!-- User Investments -->
  <h3 class="mt-5 mb-3">Your Investments</h3>
  <div class="table-responsive">
    <table class="table table-striped investment-table">
      <thead>
        <tr>
          <th>Plan</th>
          <th>Amount Invested</th>
          <th>Start Date</th>
          <th>Duration</th>
          <th>Interest Rate</th>
          <th>Current Value</th>
          <th>Returns</th>
        </tr>
      </thead>
      <tbody id="user-investments-body">
        <tr><td colspan="7" class="text-center text-muted">No investments yet.</td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Footer -->
<footer class="bg-white shadow-sm border-top mt-5">
  <div class="container py-4">
    <div class="row align-items-center">
      <div class="col-md-4 text-center text-md-start mb-3 mb-md-0">
        <span class="fw-bold text-success fs-5"><i class="fas fa-chart-line"></i> InvestNow</span>
        <span class="d-block small text-muted mt-1">Your trusted platform for secure and transparent investments.</span>
      </div>
      <div class="col-md-4 text-center mb-3 mb-md-0">
        <ul class="list-inline mb-0">
          <li class="list-inline-item"><a href="#home" class="text-muted text-decoration-none footer-link" data-section="landing">Home</a></li>
          <li class="list-inline-item"><a href="#login" class="text-muted text-decoration-none footer-link" data-section="login">Login</a></li>
          <li class="list-inline-item"><a href="#signup" class="text-muted text-decoration-none footer-link" data-section="signup">Sign Up</a></li>
          <li class="list-inline-item"><a href="#dashboard" class="text-muted text-decoration-none footer-link" data-section="dashboard">Dashboard</a></li>
        </ul>
      </div>
      <div class="col-md-4 text-center text-md-end">
        <a href="https://www.facebook.com/investnhow" class="text-success me-3 fs-5"><i class="fab fa-facebook"></i></a>
        <a href="#" class="text-success me-3 fs-5"><i class="fab fa-twitter"></i></a>
        <a href="#" class="text-success me-3 fs-5"><i class="fab fa-linkedin"></i></a>
        <a href="#" class="text-success fs-5"><i class="fab fa-instagram"></i></a>
      </div>
    </div>
    <hr class="my-3" />
    <div class="text-center small text-muted">&copy; 2025 InvestNow. All rights reserved.</div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  let currentUser = null;
  let signupVerificationCode = null;
  let signupData = null;

  // Investment plans data
  const investmentPlans = [
    {
      id: 'plan-basic',
      name: 'Basic Plan',
      minInvestment: 100,
      maxInvestment: 1000,
      durationDays: 30,
      interestRate: 5, // percent
      description: 'A low-risk plan with steady returns over 30 days.'
    },
    {
      id: 'plan-standard',
      name: 'Standard Plan',
      minInvestment: 1000,
      maxInvestment: 5000,
      durationDays: 90,
      interestRate: 12,
      description: 'Balanced plan with moderate risk and higher returns.'
    },
    {
      id: 'plan-premium',
      name: 'Premium Plan',
      minInvestment: 5000,
      maxInvestment: 20000,
      durationDays: 180,
      interestRate: 25,
      description: 'High-return plan for experienced investors.'
    }
  ];

  // LocalStorage helpers
  function getUsers() { return JSON.parse(localStorage.getItem('users') || '{}'); }
  function saveUsers(users) { localStorage.setItem('users', JSON.stringify(users)); }
  function setCurrentUser(email) { 
    currentUser = email; 
    if(email) localStorage.setItem('currentUser', email); 
    else localStorage.removeItem('currentUser'); 
  }
  function getCurrentUser() { return localStorage.getItem('currentUser'); }

  // User investments helper
  function getUserInvestments(email) {
    const investments = JSON.parse(localStorage.getItem('investments') || '{}');
    return investments[email] || [];
  }
  function saveUserInvestments(email, investments) {
    const allInvestments = JSON.parse(localStorage.getItem('investments') || '{}');
    allInvestments[email] = investments;
    localStorage.setItem('investments', JSON.stringify(allInvestments));
  }

  // Render navigation links based on auth state
  function renderNav() {
    const navLinks = document.getElementById('nav-links');
    navLinks.innerHTML = '';
    if (currentUser) {
      navLinks.innerHTML = `
        <li class="nav-item"><a href="#dashboard" class="nav-link active" id="nav-dashboard">Dashboard</a></li>
        <li class="nav-item"><a href="#logout" class="nav-link" id="nav-logout">Logout</a></li>
      `;
    } else {
      navLinks.innerHTML = `
        <li class="nav-item"><a href="#home" class="nav-link active" id="nav-home-link">Home</a></li>
        <li class="nav-item"><a href="#login" class="nav-link" id="nav-login">Login</a></li>
        <li class="nav-item"><a href="#signup" class="nav-link" id="nav-signup">Sign Up</a></li>
      `;
    }
    document.querySelectorAll('.nav-link').forEach(link => link.addEventListener('click', navHandler));
  }

  // Navigation click handler
  function navHandler(e) {
    e.preventDefault();
    const id = e.target.id;
    if (id === 'nav-dashboard') navigateTo('dashboard');
    else if (id === 'nav-login') navigateTo('login');
    else if (id === 'nav-signup') navigateTo('signup');
    else if (id === 'nav-logout') logout();
    else if (id === 'nav-home-link' || id === 'nav-home') navigateTo('landing');
  }

  // Show/hide sections
  function showSection(section) {
    ['landing-section','login-section','signup-section','dashboard-section'].forEach(id => document.getElementById(id).style.display = 'none');
    if (section === 'dashboard') {
      if (!currentUser) { showSection('login'); return; }
      document.getElementById('dashboard-section').style.display = '';
      const users = getUsers();
      document.getElementById('userName').innerText = users[currentUser]?.fullName || currentUser;
      renderDashboard();
    } else if (section === 'login') {
      document.getElementById('login-section').style.display = '';
    } else if (section === 'signup') {
      document.getElementById('signup-section').style.display = '';
      document.getElementById('verification-section').classList.add('d-none');
      document.getElementById('signup-fields').classList.remove('d-none');
    } else {
      document.getElementById('landing-section').style.display = '';
    }
  }

  // Navigate and update URL hash
  function navigateTo(section) {
    let hash = '';
    if (section === 'landing' || section === 'home') hash = '#home';
    else if (section === 'login') hash = '#login';
    else if (section === 'signup') hash = '#signup';
    else if (section === 'dashboard') hash = '#dashboard';
    window.location.hash = hash;
    showSection(section);
  }

  // Calculate returns for an investment
  function calculateInvestmentReturn(investment) {
    const plan = investmentPlans.find(p => p.id === investment.planId);
    if (!plan) return 0;

    const startDate = new Date(investment.startDate);
    const now = new Date();
    const elapsedDays = Math.floor((now - startDate) / (1000 * 60 * 60 * 24));
    const effectiveDays = Math.min(elapsedDays, plan.durationDays);

    // Simple interest formula: principal * rate * time
    const returns = investment.amount * (plan.interestRate / 100) * (effectiveDays / plan.durationDays);
    return returns;
  }

  // Render dashboard summary and investments
  function renderDashboard() {
    const investments = getUserInvestments(currentUser);
    if (investments.length === 0) {
      document.getElementById('user-investments-body').innerHTML = `<tr><td colspan="7" class="text-center text-muted">No investments yet.</td></tr>`;
      document.getElementById('total-invested').innerText = '$0.00';
      document.getElementById('current-value').innerText = '$0.00';
      document.getElementById('total-returns').innerText = '$0.00';
    } else {
      let totalInvested = 0, totalReturns = 0;
      const tbody = document.getElementById('user-investments-body');
      tbody.innerHTML = '';
      const users = getUsers();
      investments.forEach(inv => {
        const plan = investmentPlans.find(p => p.id === inv.planId);
        if (!plan) return;

        const returns = calculateInvestmentReturn(inv);
        const currentValue = inv.amount + returns;
        totalInvested += inv.amount;
        totalReturns += returns;

        const startDate = new Date(inv.startDate);
        const durationText = `${plan.durationDays} days`;

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${plan.name}</td>
          <td>$${inv.amount.toFixed(2)}</td>
          <td>${startDate.toLocaleDateString()}</td>
          <td>${durationText}</td>
          <td>${plan.interestRate}%</td>
          <td>$${currentValue.toFixed(2)}</td>
          <td>$${returns.toFixed(2)}</td>
        `;
        tbody.appendChild(tr);
      });
      document.getElementById('total-invested').innerText = `$${totalInvested.toFixed(2)}`;
      document.getElementById('current-value').innerText = `$${(totalInvested + totalReturns).toFixed(2)}`;
      document.getElementById('total-returns').innerText = `$${totalReturns.toFixed(2)}`;
    }

    renderInvestmentPlans();
  }

  // Render investment plans with invest buttons
  function renderInvestmentPlans() {
    const container = document.getElementById('investment-plans');
    container.innerHTML = '';
    investmentPlans.forEach(plan => {
      const col = document.createElement('div');
      col.className = 'col-md-4 mb-4';
      col.innerHTML = `
        <div class="plan-card p-4 h-100 d-flex flex-column justify-content-between">
          <div>
            <h5 class="fw-bold">${plan.name}</h5>
            <p class="text-muted">${plan.description}</p>
            <ul class="list-unstyled small mb-3">
              <li><strong>Min Investment:</strong> $${plan.minInvestment}</li>
              <li><strong>Max Investment:</strong> $${plan.maxInvestment}</li>
              <li><strong>Duration:</strong> ${plan.durationDays} days</li>
              <li><strong>Interest Rate:</strong> ${plan.interestRate}%</li>
            </ul>
          </div>
          <button class="btn btn-success invest-btn" data-plan-id="${plan.id}">Invest Now</button>
        </div>
      `;
      container.appendChild(col);
    });

    // Add event listeners to invest buttons
    document.querySelectorAll('.invest-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const planId = btn.getAttribute('data-plan-id');
        openInvestModal(planId);
      });
    });
  }

  // Open modal to invest in a plan
  function openInvestModal(planId) {
    const plan = investmentPlans.find(p => p.id === planId);
    if (!plan) return;

    // Create modal HTML dynamically
    let modalHtml = `
      <div class="modal fade" id="investModal" tabindex="-1" aria-labelledby="investModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <form id="investForm">
              <div class="modal-header">
                <h5 class="modal-title text-success" id="investModalLabel">Invest in ${plan.name}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <p>${plan.description}</p>
                <div class="mb-3">
                  <label for="invest-amount" class="form-label">Investment Amount ($)</label>
                  <input type="number" class="form-control" id="invest-amount" name="amount" min="${plan.minInvestment}" max="${plan.maxInvestment}" required placeholder="Between $${plan.minInvestment} and $${plan.maxInvestment}">
                  <div class="form-text">Minimum: $${plan.minInvestment}, Maximum: $${plan.maxInvestment}</div>
                </div>
                <div id="invest-error" class="text-danger d-none"></div>
              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-success">Invest</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    `;

    // Append modal to body
    const existingModal = document.getElementById('investModal');
    if (existingModal) existingModal.remove();
    document.body.insertAdjacentHTML('beforeend', modalHtml);

    // Show modal
    const investModal = new bootstrap.Modal(document.getElementById('investModal'));
    investModal.show();

    // Handle invest form submission
    document.getElementById('investForm').addEventListener('submit', e => {
      e.preventDefault();
      const amountInput = document.getElementById('invest-amount');
      const investError = document.getElementById('invest-error');
      investError.classList.add('d-none');
      investError.innerText = '';

      let amount = parseFloat(amountInput.value);
      if (isNaN(amount) || amount < plan.minInvestment || amount > plan.maxInvestment) {
        investError.innerText = `Please enter an amount between $${plan.minInvestment} and $${plan.maxInvestment}.`;
        investError.classList.remove('d-none');
        return;
      }

      // Save investment
      const investments = getUserInvestments(currentUser);
      investments.push({
        planId: plan.id,
        amount,
        startDate: new Date().toISOString()
      });
      saveUserInvestments(currentUser, investments);

      investModal.hide();
      alert(`Successfully invested $${amount.toFixed(2)} in ${plan.name}.`);
      renderDashboard();
    });
  }

  // Signup form submit handler
  document.getElementById('signupForm').addEventListener('submit', function(e) {
    e.preventDefault();
    if (!document.getElementById('verification-section').classList.contains('d-none')) return; // prevent resubmit during verification

    const form = e.target;
    const fullName = form.fullName.value.trim();
    const email = form.email.value.trim().toLowerCase();

    if (!fullName || !email) {
      alert("Please fill in all required fields.");
      return;
    }

    const users = getUsers();
    if (users[email]) {
      alert("Email already registered.");
      return;
    }

    signupVerificationCode = Math.floor(100000 + Math.random() * 900000).toString();
    signupData = { fullName, email };

    // Show verification code in signup section
    document.getElementById('displayVerificationCode').innerText = signupVerificationCode;
    document.getElementById('signup-fields').classList.add('d-none');
    document.getElementById('verification-section').classList.remove('d-none');
    document.getElementById('verification-error').classList.add('d-none');
  });

  // Copy & Paste Code button handler
  document.getElementById('copyCodeBtn').addEventListener('click', () => {
    if (!signupVerificationCode) return;
    navigator.clipboard.writeText(signupVerificationCode).then(() => {
      alert("Verification code copied to clipboard.");
      const verificationInput = document.getElementById('verification-code');
      verificationInput.value = signupVerificationCode;
      verificationInput.focus();
    }, () => {
      alert("Failed to copy. Please copy the code manually: " + signupVerificationCode);
    });
  });

  // Verify button handler
  document.getElementById('verify-btn').addEventListener('click', async () => {
    const inputCode = document.getElementById('verification-code').value.trim();
    if (inputCode !== signupVerificationCode) {
      document.getElementById('verification-error').classList.remove('d-none');
      return;
    }
    document.getElementById('verification-error').classList.add('d-none');

    if (!signupData?.fullName || !signupData?.email) {
      alert("Signup data missing. Please try again.");
      return;
    }

    // Simulate form submission (can be replaced with actual API call)
    try {
      // Save user locally as verified
      const users = getUsers();
      users[signupData.email] = { fullName: signupData.fullName, verified: true };
      saveUsers(users);
      setCurrentUser(signupData.email);
      currentUser = signupData.email;
      renderNav();
      navigateTo('dashboard');
      document.getElementById('signupForm').reset();
      signupVerificationCode = null;
      signupData = null;
      document.getElementById('verification-section').classList.add('d-none');
      document.getElementById('signup-fields').classList.remove('d-none');
      alert('Thank you for signing up! You are now logged in.');
    } catch (error) {
      alert('Signup failed. Please try again later.');
      console.error(error);
    }
  });

  // Login form submit handler
  document.getElementById('loginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const email = document.getElementById('login-email').value.trim().toLowerCase();
    const users = getUsers();
    if (users[email] && users[email].verified) {
      setCurrentUser(email);
      currentUser = email;
      renderNav();
      navigateTo('dashboard');
    } else {
      const alertEl = document.getElementById('login-alert');
      alertEl.innerText = "Invalid or unverified email.";
      alertEl.classList.remove('d-none');
    }
  });

  // Logout function
  function logout() {
    setCurrentUser(null);
    currentUser = null;
    renderNav();
    navigateTo('landing');
  }

  // Initialization
  document.getElementById('get-started-btn').onclick = () => navigateTo('signup');
  document.getElementById('nav-home').onclick = e => { e.preventDefault(); navigateTo('landing'); };
  document.getElementById('logout-btn').onclick = logout;

  window.addEventListener('hashchange', () => {
    let hash = window.location.hash.replace('#', '');
    if (!hash || hash === 'home') hash = 'landing';
    if (hash === 'dashboard' && !currentUser) hash = 'login';
    showSection(hash);
    renderNav();
  });

  window.onload = () => {
    currentUser = getCurrentUser();
    renderNav();
    let hash = window.location.hash.replace('#', '');
    if (!hash || hash === 'home') hash = 'landing';
    if (hash === 'dashboard' && !currentUser) hash = 'login';
    showSection(hash);
  };
</script>
</body>
</html>
